(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2135:(e,t,r)=>{"use strict";r.d(t,{default:()=>T});var a=r(5155),s=r(2115),o=r(965),i=r(3158),n=r(2236),d=r(9434),l=r(9708),c=r(2085);let u=(0,c.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-sea-green text-ivory hover:bg-pine-green shadow-md",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-sage-green text-sage-green bg-ivory hover:bg-sage-green hover:text-ivory",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline",accent:"bg-muted-teal text-ivory hover:bg-pine-green"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),f=s.forwardRef((e,t)=>{let{className:r,variant:s,size:o,asChild:i=!1,...n}=e,c=i?l.DX:"button";return(0,a.jsx)(c,{className:(0,d.cn)(u({variant:s,size:o,className:r})),ref:t,...n})});function m(e){let{className:t,classNames:r,showOutsideDays:s=!0,calendarClassName:l,...c}=e;return(0,a.jsx)(n.hv,{showOutsideDays:s,className:(0,d.cn)("p-3",t,l),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,d.cn)(u({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,d.cn)(u({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...r},components:{IconLeft:e=>{let{className:t,...r}=e;return(0,a.jsx)(o.A,{className:(0,d.cn)("h-4 w-4",t),...r})},IconRight:e=>{let{className:t,...r}=e;return(0,a.jsx)(i.A,{className:(0,d.cn)("h-4 w-4",t),...r})}},...c})}f.displayName="Button",m.displayName="Calendar";var p=r(939);let g=p.bL,b=p.l9,x=s.forwardRef((e,t)=>{let{className:r,align:s="center",sideOffset:o=4,...i}=e;return(0,a.jsx)(p.ZL,{children:(0,a.jsx)(p.UC,{ref:t,align:s,sideOffset:o,className:(0,d.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...i})})});x.displayName=p.UC.displayName;var h=r(3941),v=r(9140),y=r(3013);let w=s.forwardRef((e,t)=>{let{className:r,type:s,...o}=e;return(0,a.jsx)("input",{type:s,className:(0,d.cn)("flex h-10 w-full rounded-md border border-slate-gray bg-ivory px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-stone-gray focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...o})});w.displayName="Input";var j=r(968);let N=(0,c.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),S=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(j.b,{ref:t,className:(0,d.cn)(N(),r),...s})});S.displayName=j.b.displayName;var k=r(7481),_=r(7368);let C="LOCAL175",E=(e,t)=>{if(e<=0)return 0;let r=t?175:275,a=Math.floor(e/30),s=e%30;return Math.min(a*r+Math.min(65*Math.floor(s/7)+s%7*10,65*Math.ceil(s/7),10*s),10*e,65*Math.ceil(e/7),Math.ceil(e/30)*r)},P=(0,_.c)("pk_live_51K4Jm2Greyv23Im6UmwVWD8fOir20KSotBpgCKx8MDF2vtrGkA7uZGJintFSCgsOhPwpISzTPtXb8mZjAn2vAwBO00NOehIlH5"),T=()=>{let[e,t]=(0,s.useState)(void 0),[r,o]=(0,s.useState)(void 0),[i,n]=(0,s.useState)(0),[l,c]=(0,s.useState)(""),[u,p]=(0,s.useState)(""),[j,N]=(0,s.useState)(!1),[_,T]=(0,s.useState)(0),[D,O]=(0,s.useState)(!1),{toast:A}=(0,k.dj)(),[I,M]=(0,s.useState)("");(0,s.useEffect)(()=>{t(new Date)},[]),(0,s.useEffect)(()=>{let t=!1;if(u.toUpperCase()===C?(t=!0,j||A({title:"Coupon Applied",description:"Monthly rate adjusted to $".concat(175,".")})):j&&""!==u&&A({title:"Coupon Removed",description:"Coupon code is invalid or removed.",variant:"destructive"}),N(t),e&&r&&(0,h.d)(r,e)){let a=(0,v.m)(r,e);n(a),T(E(a,t))}else n(0),T(0)},[e,r,u,j,A]);let F=async t=>{if(t.preventDefault(),O(!0),!e||!r||i<=0||!l||!I){let t="Please ensure all fields are filled correctly. ";e||(t+="Select a valid entry date. "),r||(t+="Select a valid exit date. "),e&&r&&i<=0?t+="Exit date must be after the entry date. ":i<=0&&e&&r&&(t+="Entry and Exit dates cannot be the same. "),l||(t+="License plate is required. "),I||(t+="Truck number is required. "),A({title:"Error",description:t.trim(),variant:"destructive"}),O(!1);return}let a=u.toUpperCase()===C;u&&!a&&A({title:"Invalid Coupon",description:"The entered coupon code is not valid. Proceeding without discount.",variant:"destructive"});try{let t=await fetch("/api/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:(0,y.GP)(e,"yyyy-MM-dd"),exitDate:(0,y.GP)(r,"yyyy-MM-dd"),duration:i.toString(),price:_.toString(),licensePlate:l,truckNumber:I,couponCode:a?u:void 0})}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to create checkout session.");if(s.sessionId){let e=await P;if(!e)throw Error("Stripe.js failed to load.");let{error:t}=await e.redirectToCheckout({sessionId:s.sessionId});t&&(console.error("Stripe redirect error:",t),A({title:"Checkout Error",description:t.message||"Failed to redirect to Stripe.",variant:"destructive"}))}else throw Error("No session ID received from server.")}catch(e){console.error("Checkout failed:",e),A({title:"Checkout Failed",description:e instanceof Error?e.message:"An unexpected error occurred during checkout.",variant:"destructive"})}finally{O(!1)}},R=new Date(new Date().setHours(0,0,0,0));return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"text-center text-2xl font-semibold text-slate-gray mb-4",children:"JRiley Park & Pay"}),(0,a.jsx)("h1",{className:"text-center",children:"Book Your Parking Space"}),(0,a.jsxs)("form",{onSubmit:F,className:"max-w-md mx-auto space-y-4 p-4 bg-ivory/80",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(S,{htmlFor:"entryDate",className:"block text-sm font-medium text-slate-gray mb-1 font-bold",children:"Select Entry Date"}),(0,a.jsxs)(g,{children:[(0,a.jsx)(b,{asChild:!0,children:(0,a.jsx)(f,{variant:"outline",className:(0,d.cn)("w-[240px] justify-start text-left font-normal",!e&&"text-stone-gray"),id:"entryDate",children:e?(0,y.GP)(e,"PPP"):(0,a.jsx)("span",{children:"Pick an entry date"})})}),(0,a.jsx)(x,{className:"w-auto p-0",children:(0,a.jsx)(m,{mode:"single",selected:e,onSelect:e=>{t(e),r&&e&&(0,h.d)(e,r)&&o(void 0)},disabled:e=>e<R,initialFocus:!0,className:"custom-calendar"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(S,{htmlFor:"exitDate",className:"block text-sm font-medium text-slate-gray mb-1 font-bold",children:"Select Exit Date"}),(0,a.jsxs)(g,{children:[(0,a.jsx)(b,{asChild:!0,children:(0,a.jsx)(f,{variant:"outline",className:(0,d.cn)("w-[240px] justify-start text-left font-normal",!r&&"text-stone-gray"),id:"exitDate",disabled:!e,children:r?(0,y.GP)(r,"PPP"):(0,a.jsx)("span",{children:"Pick an exit date"})})}),(0,a.jsx)(x,{className:"w-auto p-0",children:(0,a.jsx)(m,{mode:"single",selected:r,onSelect:o,disabled:t=>!e||t<=e,initialFocus:!0,className:"custom-calendar"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(S,{htmlFor:"couponCode",className:"block text-sm font-medium text-slate-gray mb-1 font-bold",children:"Coupon Code (Optional)"}),(0,a.jsx)(w,{type:"text",id:"couponCode",className:"block w-full rounded-md border-input bg-ivory border-2 px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-stone-gray focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:u,onChange:e=>p(e.target.value),placeholder:"Enter coupon code"}),j&&(0,a.jsx)("p",{className:"text-sm text-green-600 mt-1",children:"Coupon 'LOCAL175' applied! Monthly rate is now $175."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(S,{htmlFor:"licensePlate",className:"block text-sm font-medium text-slate-gray mb-1 font-bold",children:"License Plate Number"}),(0,a.jsx)(w,{type:"text",id:"licensePlate",className:"block w-full rounded-md border-input bg-ivory border-2 px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-stone-gray focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:l,onChange:e=>c(e.target.value),placeholder:"Enter license plate number",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(S,{htmlFor:"truckNumber",className:"block text-sm font-medium text-slate-gray mb-1 font-bold",children:"Truck Number"}),(0,a.jsx)(w,{type:"text",id:"truckNumber",className:"block w-full rounded-md border-input bg-ivory border-2 px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-stone-gray focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",value:I,onChange:e=>M(e.target.value),placeholder:"Enter truck number",required:!0})]}),i>0&&(0,a.jsxs)("div",{className:"text-md text-stone-gray",children:["Duration: ",i," day(s)"]}),_>0&&(0,a.jsxs)("div",{className:"text-lg font-semibold text-slate-gray",children:["Total Price: $",_]}),(0,a.jsx)(f,{type:"submit",className:"w-full bg-[#003366] text-white hover:bg-[#002244] focus-visible:ring-[#003366]",disabled:D||i<=0||_<=0||!l||!I||!e||!r,children:D?"Processing...":"Proceed to Checkout"})]})]})}},7249:(e,t,r)=>{Promise.resolve().then(r.bind(r,2135))},7481:(e,t,r)=>{"use strict";r.d(t,{dj:()=>f});var a=r(2115);let s=0,o=new Map,i=e=>{if(o.has(e))return;let t=setTimeout(()=>{o.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);o.set(e,t)},n=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?i(r):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],l={toasts:[]};function c(e){l=n(l,e),d.forEach(e=>{e(l)})}function u(e){let{...t}=e,r=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||a()}}}),{id:r,dismiss:a,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function f(){let[e,t]=a.useState(l);return a.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},9434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>o});var a=r(2596),s=r(9688);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[511,239,419,441,684,358],()=>t(7249)),_N_E=e.O()}]);